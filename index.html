<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>xxxxx</title>
<meta name="description" content="xxxxx — a flappy bird-style focus game to improve concentration and reduce distractions." />
<style>
  :root{
    --header-h:64px;
    --ad-h-desktop:90px;
    --ad-h-mobile:70px;
    --max-center-w:420px;
  }
  html,body{
    height:100%;
    margin:0;
    font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial;
    background: linear-gradient(#70c5ce,#ffffff);
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
  }

  /* header */
  .site-header{
    position:fixed; top:0; left:0; right:0;
    height:var(--header-h);
    display:flex; align-items:center; justify-content:center;
    background:#0b6edc; color:#fff;
    font-weight:800; letter-spacing:1px; z-index:60;
    box-shadow:0 2px 6px rgba(0,0,0,0.08);
    font-size:20px;
  }

  /* ad under header */
  .ad-banner{
    position:fixed; left:0; right:0;
    top:var(--header-h);
    height:var(--ad-h-desktop);
    display:flex; align-items:center; justify-content:center;
    background:#fff; z-index:50; border-bottom:1px solid #eee;
  }
  .ad-banner img{ max-width:100%; height:auto; display:block; }

  /* main area under header+ad */
  .page {
    position: absolute;
    top: calc(var(--header-h) + var(--ad-h-desktop));
    left:0; right:0; bottom:0;
    display:flex; justify-content:center; align-items:center;
    padding:14px; overflow:hidden; /* desktop: no scroll */
  }

  .layout {
    width:100%; max-width:1200px;
    display:flex; gap:18px; align-items:center; justify-content:center;
  }

  .side {
    width:300px; min-width:220px;
    max-height: calc(100vh - 200px);
    background: rgba(255,255,255,0.95);
    padding:14px; border-radius:10px; overflow:auto;
    box-shadow:0 8px 22px rgba(0,0,0,0.08);
  }
  .side h2{ margin:0 0 8px 0; font-size:18px; color:#222; }
  .side p{ margin-bottom:10px; color:#333; font-size:14px; line-height:1.45; }

  .center {
    width:var(--max-center-w);
    flex:0 0 var(--max-center-w);
    display:flex; flex-direction:column; align-items:center; gap:10px;
  }

  /* canvas: actual pixel size handled in JS */
  canvas{
    width:100%; height:auto; display:block; border-radius:12px;
    background: linear-gradient(#9fe6ea,#70c5ce);
    box-shadow:0 12px 30px rgba(0,0,0,0.14);
  }

  .controls { display:flex; gap:10px; align-items:center; justify-content:center; }
  .btn {
    background:#0b6edc; color:#fff; border:none; padding:8px 14px; border-radius:8px;
    cursor:pointer; font-weight:600;
  }
  .btn.alt { background:#666; }

  #replayBtn {
    display:none;
    margin-top:6px;
    background:#ff6b35; color:#fff; border:none; padding:10px 16px; border-radius:8px;
    cursor:pointer; font-weight:700;
  }

  /* HUD DOM (best & current) placed above canvas center area */
  .hud {
    width:100%; display:flex; justify-content:space-between; align-items:center;
    font-weight:700; color:#111;
  }

  /* MOBILE: stack layout and allow scroll */
  @media (max-width:900px){
    :root{ --ad-h-desktop: var(--ad-h-mobile); }
    .page { top: calc(var(--header-h) + var(--ad-h-mobile)); overflow:auto; }
    .layout { flex-direction:column; align-items:center; padding-bottom:30px; }
    .side { width:92%; max-width:420px; min-width:unset; max-height:none; }
    .center { width:92%; max-width:420px; flex:0 0 auto; }
    .ad-banner { height:var(--ad-h-mobile); }
    .site-header { font-size:18px; height:56px; }
    html,body { -webkit-overflow-scrolling:touch; }
  }
</style>
</head>
<body>

  <!-- Header -->
  <div class="site-header" role="banner" aria-label="site title">xxxxx</div>

  <!-- Ad -->
  <div class="ad-banner" role="region" aria-label="top advertisement">
    <a href="https://secure.switchkonnect.com/aff.php?aff=1434" rel="nofollow" target="_blank" aria-label="Ad link">
      <img src="http://secure.switchkonnect.com/aff_ban/Webbanner_728x90px_3.jpg" alt="Ad banner">
    </a>
  </div>

  <!-- Main -->
  <div class="page" role="main">
    <div class="layout">

      <aside class="side" aria-labelledby="aboutTitle">
        <h2 id="aboutTitle">About xxxxx</h2>
        <p><strong>xxxxx</strong> is a quick browser game to build focus — a mindful break you can play in under a minute.</p>
        <p>Tap/click or press Space to flap. Short sessions help re-focus your attention and replace impulsive browsing habits.</p>
      </aside>

      <main class="center" role="application" aria-label="game area">
        <div class="hud">
          <div>Score: <span id="domScore">0</span></div>
          <div>Best: <span id="domBest">0</span></div>
        </div>

        <canvas id="c"></canvas>

        <div class="controls" role="group" aria-label="controls">
          <button id="startBtn" class="btn">Start</button>
          <button id="muteBtn" class="btn alt">Mute</button>
        </div>

        <button id="replayBtn">Replay</button>
        <div style="font-size:13px;color:#333;margin-top:6px;text-align:center;">Tap/click or press <kbd>Space</kbd> to flap</div>
      </main>

      <aside class="side" aria-labelledby="faqTitle">
        <h2 id="faqTitle">FAQ</h2>
        <p><strong>What is xxxxx?</strong><br>xxxxx is a simple flappy-bird style game to help you practice short mindful play sessions.</p>
        <p><strong>Mobile friendly?</strong><br>Yes — ad and header remain fixed; page scroll is allowed on mobile to access About/FAQ.</p>
      </aside>

    </div>
  </div>

<script>
/* ---------- Robust game implementation ---------- */
/* High-DPI canvas handling, stable physics, proper input, score HUD, gameover overlay + replay. */

const canvas = document.getElementById('c');
const ctx = canvas.getContext('2d');

const LOGIC_W = 420;
const LOGIC_H = 600;

function resizeCanvas(){
  const dpr = Math.min(window.devicePixelRatio || 1, 2);
  // CSS width: max 420 but responsive for smaller screens
  const cssW = Math.min(LOGIC_W, Math.max(260, Math.min(window.innerWidth - 40, LOGIC_W)));
  const cssH = Math.round(cssW * (LOGIC_H / LOGIC_W));
  canvas.style.width = cssW + 'px';
  canvas.style.height = cssH + 'px';
  canvas.width = Math.round(cssW * dpr);
  canvas.height = Math.round(cssH * dpr);
  ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
  canvas.logicalWidth = cssW;
  canvas.logicalHeight = cssH;
}
window.addEventListener('resize', resizeCanvas);
resizeCanvas();

/* state */
let running = false;
let frames = 0;
let spawnTimer = 0;
let pipes = [];
let score = 0;
let best = parseInt(localStorage.getItem('xxxxx_best') || '0', 10) || 0;
document.getElementById('domBest').textContent = best;
document.getElementById('domScore').textContent = score;
let muted = false;

/* bird */
const bird = {
  x: 80,
  y: canvas.logicalHeight/2,
  r: 14,
  vy: 0,
  gravity: 0.45,
  jump: -8,
  rotation: 0,
  reset(){
    this.y = canvas.logicalHeight / 2;
    this.vy = 0;
    this.rotation = 0;
  },
  flap(){
    this.vy = this.jump;
    playTone(750,0.06);
  },
  update(){
    this.vy += this.gravity;
    this.y += this.vy;
    if(this.vy < 0) this.rotation = -0.6; else this.rotation = Math.min(1.2, this.rotation + 0.05);
    // ground collision
    if(this.y + this.r > canvas.logicalHeight - 20){
      this.y = canvas.logicalHeight - 20 - this.r;
      this.vy = 0;
      running = false;
      playTone(140,0.12);
    }
    if(this.y - this.r < 0){
      this.y = this.r;
      this.vy = 0;
    }
  },
  draw(){
    ctx.save();
    ctx.translate(this.x, this.y);
    ctx.rotate(this.rotation);
    // body
    ctx.fillStyle = '#ffd633'; ctx.strokeStyle = '#d6a900'; ctx.lineWidth = 2;
    ctx.beginPath(); ctx.ellipse(0,0,this.r*1.3,this.r,0,0,Math.PI*2); ctx.fill(); ctx.stroke();
    // eye
    ctx.fillStyle = '#000'; ctx.beginPath(); ctx.arc(5,-3,2.4,0,Math.PI*2); ctx.fill();
    // beak
    ctx.fillStyle = '#ff7a00'; ctx.beginPath(); ctx.moveTo(10,0); ctx.lineTo(18,-6); ctx.lineTo(18,6); ctx.closePath(); ctx.fill();
    ctx.restore();
  }
};

/* pipes */
const PIPE_W = 60;
const GAP = 150;
const PIPE_SPEED = 2.8;
function spawnPipe(){
  const minGapTop = 80;
  const maxGapTop = Math.max(120, canvas.logicalHeight - 240);
  const cy = Math.floor(Math.random() * (canvas.logicalHeight - 240)) + 120;
  pipes.push({ x: canvas.logicalWidth + PIPE_W, centerY: cy, passed:false });
}
function updatePipes(){
  for(let i = pipes.length -1; i >= 0; i--){
    const p = pipes[i];
    p.x -= PIPE_SPEED;
    // score detection
    if(!p.passed && p.x + PIPE_W/2 < bird.x){
      p.passed = true;
      score++;
      document.getElementById('domScore').textContent = score;
      playTone(950,0.04);
      if(score > best){ best = score; localStorage.setItem('xxxxx_best', best); document.getElementById('domBest').textContent = best; }
    }
    if(p.x + PIPE_W < -50) pipes.splice(i,1);
    // collision will be checked elsewhere
  }
}
function drawPipes(){
  ctx.fillStyle = '#2E8B57'; ctx.strokeStyle = '#1f5d3d'; ctx.lineWidth = 3;
  for(const p of pipes){
    const topH = p.centerY - (GAP/2);
    const bottomY = p.centerY + (GAP/2);
    // top pipe
    ctx.fillRect(p.x, 0, PIPE_W, topH);
    ctx.strokeRect(p.x, 0, PIPE_W, topH);
    // bottom pipe
    ctx.fillRect(p.x, bottomY, PIPE_W, canvas.logicalHeight - bottomY);
    ctx.strokeRect(p.x, bottomY, PIPE_W, canvas.logicalHeight - bottomY);
    // rims
    ctx.fillStyle = '#1f5d3d';
    ctx.fillRect(p.x-2, topH-10, PIPE_W+4, 12);
    ctx.fillRect(p.x-2, bottomY, PIPE_W+4, 12);
    ctx.fillStyle = '#2E8B57';
  }
}

/* collision helper: circle vs rect */
function circleRect(cx, cy, r, rx, ry, rw, rh){
  const closestX = Math.max(rx, Math.min(cx, rx+rw));
  const closestY = Math.max(ry, Math.min(cy, ry+rh));
  const dx = cx - closestX; const dy = cy - closestY;
  return (dx*dx + dy*dy) < (r*r);
}

/* draw ground */
function drawGround(){
  ctx.fillStyle = '#DEB887'; ctx.fillRect(0, canvas.logicalHeight - 20, canvas.logicalWidth, 20);
}

/* HUD inside canvas */
function drawHUD(){
  ctx.fillStyle = 'rgba(0,0,0,0.75)';
  ctx.font = '20px system-ui, Arial';
  ctx.textAlign = 'center';
  ctx.fillText('Score: ' + score, canvas.logicalWidth / 2, 36);
}

/* Game over overlay (drawn in canvas) */
function drawGameOver(){
  ctx.fillStyle = 'rgba(0,0,0,0.5)';
  ctx.fillRect(0,0,canvas.logicalWidth, canvas.logicalHeight);
  ctx.fillStyle = '#fff';
  ctx.font = '28px system-ui, Arial';
  ctx.textAlign = 'center';
  ctx.fillText('Game Over', canvas.logicalWidth/2, canvas.logicalHeight/2 - 36);
  ctx.font = '20px system-ui, Arial';
  ctx.fillText('Score: ' + score, canvas.logicalWidth/2, canvas.logicalHeight/2);
  ctx.fillText('Best: ' + best, canvas.logicalWidth/2, canvas.logicalHeight/2 + 30);
  // show DOM replay
  const replayBtn = document.getElementById('replayBtn');
  replayBtn.style.display = 'block';
}

/* update & draw */
function resetGame(){
  pipes = []; frames = 0; spawnTimer = 0; score = 0;
  document.getElementById('domScore').textContent = score;
  bird.reset();
  running = false;
  document.getElementById('replayBtn').style.display = 'none';
}
function startGame(){
  resetGame();
  running = true;
  bird.flap(); // initial flap so player feels responsive
}

function update(){
  if(running){
    frames++;
    bird.update();
    spawnTimer++;
    if(spawnTimer > 110){ spawnTimer = 0; spawnPipe(); }
    updatePipes();
    // collision checks
    for(const p of pipes){
      const topH = p.centerY - (GAP/2);
      const bottomY = p.centerY + (GAP/2);
      if(circleRect(bird.x, bird.y, bird.r, p.x, 0, PIPE_W, topH) ||
         circleRect(bird.x, bird.y, bird.r, p.x, bottomY, PIPE_W, canvas.logicalHeight - bottomY)){
        running = false;
        playTone(140,0.12);
      }
    }
  } else {
    frames++;
    // idle bob
    bird.y = canvas.logicalHeight/2 + Math.sin(frames/12) * 6;
  }
}

function draw(){
  // clear
  ctx.fillStyle = '#9fe6ea';
  ctx.fillRect(0,0,canvas.logicalWidth, canvas.logicalHeight);

  drawPipes();
  drawGround();
  bird.draw();
  drawHUD();

  if(!running && frames > 0){
    drawGameOver();
  } else if(!running && frames === 0){
    // show start hint
    ctx.fillStyle = 'rgba(0,0,0,0.85)';
    ctx.font = '18px system-ui, Arial';
    ctx.textAlign = 'center';
    ctx.fillText('Tap / Click or press Space to start', canvas.logicalWidth/2, canvas.logicalHeight/2 - 10);
  }
}

/* Main loop */
function loop(){
  update();
  draw();
  requestAnimationFrame(loop);
}

/* Input handling */
function getCanvasPosFromEvent(e){
  const rect = canvas.getBoundingClientRect();
  const clientX = e.touches ? e.touches[0].clientX : e.clientX;
  const clientY = e.touches ? e.touches[0].clientY : e.clientY;
  const x = clientX - rect.left;
  const y = clientY - rect.top;
  // convert CSS coords to logical (we kept logical = CSS px)
  return { x, y };
}

canvas.addEventListener('pointerdown', (ev) => {
  // unify pointer, touch, mouse
  ev.preventDefault();
  if(!running && frames === 0){
    startGame();
    return;
  }
  if(!running){
    startGame();
    return;
  }
  bird.flap();
});
window.addEventListener('keydown', (e) => {
  if(e.code === 'Space'){
    e.preventDefault();
    if(!running && frames === 0){
      startGame();
      return;
    }
    if(!running){
      startGame();
      return;
    }
    bird.flap();
  }
});

/* UI buttons */
document.getElementById('startBtn').addEventListener('click', () => {
  if(!running) startGame();
  bird.flap();
});
document.getElementById('replayBtn').addEventListener('click', () => {
  resetGame();
  startGame();
});
document.getElementById('muteBtn').addEventListener('click', function(){
  muted = !muted;
  this.textContent = muted ? 'Unmute' : 'Mute';
});

/* audio */
let audioCtx = null;
function ensureAudio(){
  if(!audioCtx){
    try{ audioCtx = new (window.AudioContext || window.webkitAudioContext)(); }catch(e){ audioCtx = null; }
  }
}
function playTone(freq, dur=0.06){
  if(muted) return;
  ensureAudio();
  if(!audioCtx) return;
  const o = audioCtx.createOscillator();
  const g = audioCtx.createGain();
  o.type = 'sine'; o.frequency.value = freq;
  g.gain.value = 0.08;
  o.connect(g); g.connect(audioCtx.destination);
  o.start(); g.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + dur);
  o.stop(audioCtx.currentTime + dur + 0.02);
}

/* init */
function init(){
  resizeCanvas(); // set sizes
  bird.reset();
  frames = 0; spawnTimer = 0; running = false;
  document.getElementById('domBest').textContent = best;
  document.getElementById('domScore').textContent = score;
  document.getElementById('replayBtn').style.display = 'none';
  loop();
}
window.addEventListener('resize', () => {
  resizeCanvas();
  // keep bird within bounds after resize
  bird.y = Math.min(canvas.logicalHeight - 30, Math.max(bird.r + 2, bird.y));
});
init();

</script>
</body>
</html>
